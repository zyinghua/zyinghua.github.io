<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Leetcode 142: Linked List Cycle II | Yinghua Zhou </title> <meta name="author" content="Yinghua Zhou"> <meta name="description" content="A detailed solution to the Linked List Cycle II problem using Floyd's cycle-finding algorithm"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.jpg?4a9a55aad5a5c55b3b627347fdf25860"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zyinghua.github.io/blog/2022/leetcode-142/"> <script src="/assets/js/theme.js?cf5cbd73b0ea60e4cb40a0e50b7681ca"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Yinghua</span> Zhou </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="wrapper"> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Leetcode 142: Linked List Cycle II</h1> <p class="post-meta"> Created on January 20, 2022 </p> <p class="post-tags"> <a href="/blog/2022"> <i class="fa-solid fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/leetcode"> <i class="fa-solid fa-hashtag fa-sm"></i> leetcode</a>   <a href="/blog/tag/algorithms"> <i class="fa-solid fa-hashtag fa-sm"></i> algorithms</a>   <a href="/blog/tag/solution"> <i class="fa-solid fa-hashtag fa-sm"></i> solution</a>   ·   <a href="/blog/category/leetcode"> <i class="fa-solid fa-tag fa-sm"></i> leetcode</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This question is asking for the node where the cycle begins if there’s any, without modifying the list. It may comes less intuitive at the first glance, therefore we need some kind of algorithms that can detect the cycle in a different way.</p> <h2 id="floyds-cycle-finding-algorithm"><a href="https://en.wikipedia.org/wiki/Cycle_detection" rel="external nofollow noopener" target="_blank">Floyd’s cycle-finding algorithm</a></h2> <p>The idea of this algorithm came up by <a href="https://en.wikipedia.org/wiki/Robert_W._Floyd" rel="external nofollow noopener" target="_blank">Robert W. Floyd</a>, is by using two pointers (tortoise and hare), such that one moves twice faster (2x speed) than the other, if there exists a cycle, the pointers will eventually meet at a certain point &gt;= where the cycle starts.</p> <h5 id="following-the-algorithm-consider-a-single-linked-list-with-a-cycle-like-this">Following the algorithm, consider a single linked list with a cycle like this:</h5> <p><strong>*(Suggest drawing it out to make this clear :D)</strong></p> <blockquote> <p>Head _ _ _ {x}_ _ _ Cycle(S)_ _ _ {y}_ _ _ Meeting point(M)_ _ _ {z}_ _ _ Cycle(S)_ _ _ _</p> </blockquote> <p>We know that at the meeting point (M), the distance travelled by the tortoise (the slow pointer) will be x + y, and for the hare (the fast pointer) will be x + y + z + y = x + 2y + z. Since we know the time is constant and the hare moves 2x speed than the tortoise, therefore we can deduce:</p> <blockquote> <p>2 * (x + y) = x + 2y + z</p> <p>2x + 2y = x + 2y + z</p> <p>2x = x + z</p> <p>x = z</p> </blockquote> <p>Which means Distance (Head to Cycle start) equals to Distance (Meeting point to Cycle start).</p> <h4 id="another-way-to-prove-the-same-statement">Another way to prove the same statement:</h4> <blockquote> <p>Head _ _ _ {x} _ _ _ Cycle(S) _ _ _ {?} _ _ _ Meeting point(M) _ _ _ {?} _ _ _ (2x) _ _ _ {y} _ _ _ Cycle(S) _ _ _</p> </blockquote> <p>Assuming the distance between the Head and Cycle(S) is <code class="language-plaintext highlighter-rouge">x</code>, when the tortoise arrives at Cycle(S), the hare will be at <code class="language-plaintext highlighter-rouge">2x</code>. Assuming the distance between 2x and Cycle(S) by going forward is <code class="language-plaintext highlighter-rouge">y</code>, when the hare reaches Cycle(S) again by following the cycle, the tortoise will be at <code class="language-plaintext highlighter-rouge">x + y/2</code>.</p> <p>So the problem now becomes:</p> <blockquote> <p>The hare moves 2x faster than the tortoise, the distance between them now is a certain value say <code class="language-plaintext highlighter-rouge">y/2</code>, when will the hare catch the tortoise?</p> </blockquote> <p>And the answer is when the hare moves <code class="language-plaintext highlighter-rouge">y</code> distance, after a time of <code class="language-plaintext highlighter-rouge">y/2</code>.</p> <p>If we think about where the hare starts, it’s actually Cycle(S), and after <code class="language-plaintext highlighter-rouge">y</code> distance, they will meet, so the meeting point is at <code class="language-plaintext highlighter-rouge">x + y</code>.</p> <p>We know that 2x to Cycle(S) is <code class="language-plaintext highlighter-rouge">y</code>, and Distance (Meeting point to 2x) is <code class="language-plaintext highlighter-rouge">2x - (x + y)</code> = <code class="language-plaintext highlighter-rouge">x - y</code>, and so Distance (Meeting point to Cycle(S)) is <code class="language-plaintext highlighter-rouge">x - y + y</code> which is <code class="language-plaintext highlighter-rouge">x</code> itself.</p> <p>The other case happens when the meeting point occurs before 2x:</p> <blockquote> <p>Head _ _ _ {x} _ _ _ Cycle(S) _ _ _ (2x) _ _ _ Meeting point(M) _ _ _ {?} _ _ _ Cycle(S) _ _ _</p> </blockquote> <p>We can still follow the same logic and find out the meeting point is at <code class="language-plaintext highlighter-rouge">x + y</code>. And the distance from 2x to the meeting point will be <code class="language-plaintext highlighter-rouge">x + y - 2x</code> = <code class="language-plaintext highlighter-rouge">y - x</code>. With the fact the distance between 2x and Cycle(S) by going forward is <code class="language-plaintext highlighter-rouge">y</code>, Distance (Meeting point to Cycle(S)) will be <code class="language-plaintext highlighter-rouge">y - (y - x)</code> which is <code class="language-plaintext highlighter-rouge">x</code> itself.</p> <p>By knowing <code class="language-plaintext highlighter-rouge">Distance (Head to Cycle start) equals to Distance (Meeting point to Cycle start)</code>, once we detect the tortoise and the hare pointers meet, we can have a pointer starting from the head that moves with a one in the meeting point at the same speed, and the point they meet up will be Cycle(S), the start of the cycle.</p> <h2 id="summary">Summary</h2> <blockquote> <ol> <li> <p>The slow and fast pointers (tortoise and hare) will meet up if there exists a cycle, otherwise the fast pointer will reach a None node.</p> </li> <li> <p>When they reach at the meeting point, one moves from the head with the slow pointer moves from the meeting point at the same speed, the point they meet up is the start of the cycle.</p> </li> </ol> </blockquote> <h2 id="code">Code</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Definition for singly-linked list.
# class ListNode:
#     def __init__(self, x):
#         self.val = x
#         self.next = None
</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">detectCycle</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListNode</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ListNode</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">head</span><span class="p">.</span><span class="nb">next</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

        <span class="n">slow</span> <span class="o">=</span> <span class="n">head</span><span class="p">.</span><span class="nb">next</span>
        <span class="n">fast</span> <span class="o">=</span> <span class="n">head</span><span class="p">.</span><span class="nb">next</span><span class="p">.</span><span class="nb">next</span>

        <span class="k">while</span> <span class="n">fast</span> <span class="o">!=</span> <span class="n">slow</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fast</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">fast</span><span class="p">.</span><span class="nb">next</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="n">slow</span> <span class="o">=</span> <span class="n">slow</span><span class="p">.</span><span class="nb">next</span>
            <span class="n">fast</span> <span class="o">=</span> <span class="n">fast</span><span class="p">.</span><span class="nb">next</span><span class="p">.</span><span class="nb">next</span>

        <span class="n">fast</span> <span class="o">=</span> <span class="n">head</span>
        <span class="k">while</span> <span class="n">slow</span> <span class="o">!=</span> <span class="n">fast</span><span class="p">:</span>
            <span class="n">fast</span> <span class="o">=</span> <span class="n">fast</span><span class="p">.</span><span class="nb">next</span>
            <span class="n">slow</span> <span class="o">=</span> <span class="n">slow</span><span class="p">.</span><span class="nb">next</span>

        <span class="k">return</span> <span class="n">slow</span>
</code></pre></div></div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/git-access-with-vpn-proxy/">Git access with VPN proxy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/understanding-diffusion-models/">Understanding Diffusion Models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/grad-nan-solutions/">Potential Solutions when encountering the nan gradient problem with pytorch</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/conda-setup-diary/">Conda Setup Diary</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/leetcode-904/">Leetcode 904: Fruit Into Baskets</a> </li> </div> </div> </div> <footer class="sticky-bottom" role="contentinfo"> <div class="container"> © Copyright 2025 Yinghua Zhou. Template from <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. Last updated: September, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?9ea77dd81bce838cf90bb488b503a8f4"></script> <script defer src="/assets/js/mathjax-enhanced.js?0970606cfccbaf782dec0327f6d7d1f0"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/math-links-fix.js?664c6767190f6ce453eb74accd06fd88"></script> <script defer src="/assets/js/mathjax-spacing-fix.js?da573ad73b6df0501ff921517dd30d9f"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>